import { useEffect, useState } from "react";
import { Grid, Typography } from "@mui/material";
import axios from "axios";
import React from "react";

const key: string = "46079d357e9a2c65ff03fab0ab51f02c";
if (key === undefined) {
  throw new Error(
    "No Open Weather API Key defined - ensure you set a variable called REACT_APP_OPEN_WEATHER_API_KEY"
  );
}

const keyQuery = `appid=${key}`;

export const Weather = () => {
  const [temp, setTemp] = useState();
  const [hum, setHum] = useState();
  const [clouds, setClouds] = useState();
  const [city, setCity] = useState();
  const [wind, setWind] = useState();
  const [url, setUrl] = useState("");

  useEffect(() => {
    navigator.geolocation.getCurrentPosition(function (position) {
      let lat = position.coords.latitude;

      let lon = position.coords.longitude;

      // console.log(lat, lon);

      axios
        .get(
          `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&${keyQuery}`
        )
        .then((data) => {
          console.log(data);

          setCity(data.data.name);

          setTemp(data.data.main.temp);
          setHum(data.data.main.humidity);
          setClouds(data.data.weather[0].main);
          setWind(data.data.wind.speed);

          const url = `http://openweathermap.org/img/w/${data.data.weather[0].icon}.png`;
          setUrl(url);
        });
    });
  });

  return (
    <>
      <div className="footer">
        <Grid container spacing={2}>
          <Grid item xs={12}>
            <span>{city} </span>
          </Grid>
          <Grid item xs={3}>
            <div
              style={{
                fontSize: ".5rem",
                display: "flex",
                flexDirection: "column",
              }}
            >
              <img src={url} width="40" height="40"></img>
              <span>{clouds}</span>
            </div>
          </Grid>
          <Grid item xs={3}>
            <div
              style={{
                textAlign: "center",
                alignItems: "center",
                fontSize: "1rem",
                fontWeight: 100,
                display: "block",
                flexDirection: "column",
              }}
            >
              <svg
                viewBox="0 0 320 512"
                fill="currentColor"
                height="1.2em"
                width="1.2em"
              >
                <path d="M160 64c-26.5 0-48 21.5-48 48v164.5c0 17.3-7.1 31.9-15.3 42.5C86.2 332.6 80 349.5 80 368c0 44.2 35.8 80 80 80s80-35.8 80-80c0-18.5-6.2-35.4-16.7-48.9-8.2-10.6-15.3-25.2-15.3-42.5V112c0-26.5-21.5-48-48-48zM48 112C48 50.2 98.1 0 160 0s112 50.1 112 112v164.5c0 .1.1.3.2.6.2.6.8 1.6 1.7 2.8 18.9 24.4 30.1 55 30.1 88.1 0 79.5-64.5 144-144 144S16 447.5 16 368c0-33.2 11.2-63.8 30.1-88.1.9-1.2 1.5-2.2 1.7-2.8.1-.3.2-.5.2-.6V112zm160 256c0 26.5-21.5 48-48 48s-48-21.5-48-48c0-20.9 13.4-38.7 32-45.3V200c0-8.8 7.2-16 16-16s16 7.2 16 16v122.7c18.6 6.6 32 24.4 32 45.3z" />
              </svg>
              <p>{temp} </p>
            </div>
          </Grid>
          <Grid item xs={3}>
            <div>xs=8</div>
          </Grid>
          <Grid item xs={3}>
            <div>xs=8</div>
          </Grid>
        </Grid>

        {/* <table style={{ width: "100%" }} align="center">
          <thead>
            <tr>
              <th>
                <span>{city}</span>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <img src={url} width="60" height="60"></img>
                <p>{clouds}</p>
              </td>

              <td>
                <p>
                  <svg
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    height="1.5em"
                    width="1.5em"
                  >
                    <path d="M16.5 5c1.55 0 3 .47 4.19 1.28l-1.16 2.89A4.47 4.47 0 0016.5 8C14 8 12 10 12 12.5s2 4.5 4.5 4.5c1.03 0 1.97-.34 2.73-.92l1.14 2.85A7.47 7.47 0 0116.5 20 7.5 7.5 0 019 12.5 7.5 7.5 0 0116.5 5M6 3a3 3 0 013 3 3 3 0 01-3 3 3 3 0 01-3-3 3 3 0 013-3m0 2a1 1 0 00-1 1 1 1 0 001 1 1 1 0 001-1 1 1 0 00-1-1z" />
                  </svg>
                  {temp}
                </p>
                <p>
                  <svg
                    viewBox="0 0 30 30"
                    fill="currentColor"
                    height="2em"
                    width="2em"
                  >
                    <path d="M7.56 17.19c0-.88.24-1.89.72-3.03s1.1-2.25 1.86-3.31c1.56-2.06 2.92-3.62 4.06-4.67l.75-.72c.25.26.53.5.83.72.41.42 1.04 1.11 1.88 2.09s1.57 1.85 2.17 2.65c.71 1.01 1.32 2.1 1.81 3.25s.74 2.16.74 3.03c0 1-.19 1.95-.58 2.86-.39.91-.91 1.7-1.57 2.36-.66.66-1.45 1.19-2.37 1.58-.92.39-1.89.59-2.91.59-1 0-1.95-.19-2.86-.57-.91-.38-1.7-.89-2.36-1.55-.66-.65-1.19-1.44-1.58-2.35s-.59-1.89-.59-2.93zm2.26-2.93c0 .83.17 1.49.52 1.99.35.49.88.74 1.59.74.72 0 1.25-.25 1.61-.74.35-.49.53-1.15.54-1.99-.01-.84-.19-1.5-.54-2-.35-.49-.89-.74-1.61-.74-.71 0-1.24.25-1.59.74-.35.5-.52 1.16-.52 2zm1.57 0v-.35c0-.08.01-.19.02-.33s.02-.25.05-.32.05-.16.09-.24c.04-.08.09-.15.15-.18.07-.04.14-.06.23-.06.14 0 .25.04.33.12s.14.21.17.38c.03.18.05.32.06.45s.01.3.01.52c0 .23 0 .4-.01.52s-.03.27-.06.45c-.03.17-.09.3-.17.38s-.19.12-.33.12c-.09 0-.16-.02-.23-.06a.335.335 0 01-.15-.18c-.04-.08-.07-.17-.09-.24-.02-.08-.04-.19-.05-.32-.01-.14-.02-.25-.02-.32v-.34zm.59 7.75h1.32l4.99-10.74h-1.35l-4.96 10.74zm4.3-2.99c.01.84.2 1.5.55 2 .35.49.89.74 1.6.74.72 0 1.25-.25 1.6-.74.35-.49.52-1.16.53-2-.01-.84-.18-1.5-.53-1.99-.35-.49-.88-.74-1.6-.74-.71 0-1.25.25-1.6.74-.36.49-.54 1.15-.55 1.99zm1.57 0c0-.23 0-.4.01-.52s.03-.27.06-.45.09-.3.17-.38.19-.12.33-.12c.09 0 .17.02.24.06.07.04.12.1.16.19.04.09.07.17.1.24s.04.18.05.32l.01.32v.69l-.01.32-.05.32-.1.24-.16.19-.24.06c-.14 0-.25-.04-.33-.12s-.14-.21-.17-.38c-.03-.18-.05-.33-.06-.45s-.01-.3-.01-.53z" />
                  </svg>
                  {hum}%
                </p>

                <p>
                  {" "}
                  <svg
                    viewBox="0 0 30 30"
                    fill="currentColor"
                    height="2em"
                    width="2em"
                  >
                    <path d="M1.48 21.1c0 .24.09.44.27.6.17.17.37.25.61.25h5.88c.26 0 .48.09.68.28a.932.932 0 010 1.37c-.2.19-.42.29-.68.29-.26 0-.48-.1-.68-.3a.888.888 0 00-.61-.24c-.24 0-.44.08-.6.24-.16.16-.24.36-.24.6s.08.44.24.6c.53.53 1.16.8 1.89.8.74 0 1.37-.26 1.88-.78s.78-1.15.78-1.89-.26-1.37-.78-1.89c-.52-.52-1.15-.78-1.88-.78H2.36a.86.86 0 00-.62.25c-.17.17-.26.37-.26.6zm0-3.01c0 .23.09.42.27.58.16.16.37.24.61.24h10.97c.74 0 1.37-.26 1.89-.78.52-.52.78-1.15.78-1.89s-.26-1.36-.78-1.88c-.52-.51-1.15-.77-1.89-.77-.76 0-1.38.25-1.88.76-.16.16-.23.37-.23.61s.08.44.23.6c.15.15.35.23.6.23.24 0 .44-.08.62-.23.19-.19.41-.28.68-.28s.49.09.68.28.29.42.29.68c0 .27-.1.5-.29.69-.19.19-.42.29-.68.29H2.36a.87.87 0 00-.62.26c-.17.18-.26.38-.26.61zm5.79-6.54c0-.24.09-.44.26-.62.18-.16.38-.24.6-.24h2.03c.23 0 .42.08.58.25.16.17.23.37.23.61s-.08.44-.23.6c-.16.17-.35.25-.58.25H8.13c-.24 0-.44-.08-.61-.25a.816.816 0 01-.25-.6zm2.85-6.92c0-.23.08-.43.23-.61a.98.98 0 01.64-.24c.22 0 .42.08.59.24l1.43 1.47c.16.15.24.35.24.59s-.08.44-.24.6-.36.24-.59.24c-.24 0-.44-.08-.59-.24l-1.47-1.43a.86.86 0 01-.24-.62zm2.56 6.8v-.07c.02-.91.27-1.75.74-2.53A5.29 5.29 0 0115.32 7a5.11 5.11 0 012.57-.67c.7 0 1.37.14 2.02.42.64.28 1.2.65 1.66 1.12.47.47.84 1.02 1.11 1.66s.41 1.32.41 2.02c0 .94-.23 1.8-.69 2.6s-1.09 1.43-1.88 1.89a5.1 5.1 0 01-2.6.71h-.21c-.07 0-.13-.02-.17-.07a.241.241 0 01-.07-.18v-1.22c0-.13.07-.2.22-.2h.24c.96-.01 1.79-.35 2.47-1.05.68-.69 1.03-1.52 1.03-2.49 0-.96-.35-1.78-1.04-2.47-.69-.68-1.52-1.02-2.5-1.02-.94 0-1.76.32-2.44.98-.68.65-1.04 1.44-1.08 2.37 0 .06-.03.11-.08.17s-.14.09-.26.09H12.9c-.15.01-.22-.07-.22-.23zm4.35 9.88v-1.99c0-.24.08-.44.25-.6s.37-.24.6-.24a.821.821 0 01.85.84v1.99c0 .24-.08.45-.25.62-.17.17-.37.25-.6.25-.24 0-.44-.08-.6-.25a.886.886 0 01-.25-.62zm0-17.48V1.78c0-.23.08-.43.25-.6s.37-.25.6-.25c.24 0 .44.08.6.25s.25.37.25.6v2.04c0 .23-.08.42-.25.58-.17.15-.37.23-.6.23-.24 0-.44-.08-.6-.23a.756.756 0 01-.25-.57zm5.53 13.18c0-.23.08-.42.23-.56a.74.74 0 01.57-.23c.24 0 .44.08.6.23l1.45 1.42c.16.17.24.38.24.61 0 .23-.08.43-.24.59-.4.31-.8.31-1.2 0l-1.42-1.43c-.16-.16-.23-.38-.23-.63zm0-10.93c0-.25.08-.45.23-.59l1.42-1.47c.18-.16.37-.24.59-.24.23 0 .43.08.6.25.17.17.25.37.25.6 0 .25-.08.46-.24.62l-1.45 1.43c-.18.16-.38.24-.6.24-.23 0-.41-.08-.57-.24a.806.806 0 01-.23-.6zm2.26 5.47c0-.24.08-.44.24-.62.16-.16.35-.24.57-.24h2.02c.23 0 .43.09.61.26s.26.37.26.6c0 .23-.09.43-.26.6-.18.17-.38.25-.61.25h-2.02c-.23 0-.42-.08-.58-.25a.806.806 0 01-.23-.6z" />
                  </svg>
                  {wind} m/sec
                </p>
                {/* </Typography> 
              </td>
            </tr>
          </tbody>
        </table> */}
      </div>

      {/* {articles.length !== 0 && <Article article={articles[0]} />} */}
      {/* {articles.length !== 0 &&
            articles.map((el, i) => {
              return <Article article={el} key={i} />;
            })} */}
    </>
  );
};

export default Weather;
